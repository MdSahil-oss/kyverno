apiVersion: v1
data:
  foo: YmFy
metadata:
  name: regcred
  namespace: default
kind: Secret
type: Opaque
---
apiVersion: kyverno.io/v2beta1
kind: ClusterPolicy
metadata:
  name: cpol-foreach-clone-sync
  namespace: default
spec:
  rules:
  - name: cpol-foreach-clone-sync-secret
    match:
      any:
      - resources:
          kinds:
          - pod
    generate:
      foreach:
      - list: "request.object.spec.containers"
        generateResources:
        - kind: Secret
          apiVersion: v1
          name: "newsecret"
          namespace: "default"
          synchronize: true
          clone:
            namespace: default
            name: regcred
